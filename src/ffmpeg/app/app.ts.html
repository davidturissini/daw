<template>
    <header class="header">
        <ffmpeg-controls
            onsilencedetectbuttonclick={onSilenceDetectButtonClick}
            onstopbuttonclick={onStopButtonClick}
            onplaybuttonclick={onPlayButtonClick}>
        </ffmpeg-controls>
        <ffmpeg-audioscroll></ffmpeg-audioscroll>
        <span>{projectBpm} bpm</span>
    </header>
    <aside class="left-col">
        <ffmpeg-instruments></ffmpeg-instruments>
    </aside>
    <main class="body">
        <ffmpeg-grid
            class="track-grid"
            onaudiorangecreated={onTrackSegmentCreated}
            onaudiorangechange={onTrackSegmentRangeChange}
            onrangedoubleclick={onSegmentDoubleClick}
            onrangedragstart={onSegmentDragStart}
            onrangedragend={onSegmentDragEnd}
            onrangedrag={onSegmentDrag}
            rows={trackGridRows}
        >
            <section slot="col-left" class="tracks-summary">
                <section class="tracks">
                    <template for:each={audioTracksArray} for:item="track" for:index="index">
                        <article data-track-id={track.id} onkeyup={onTrackSummaryKeyUp} tabindex="0" class="track track--summary" key={track.id}>
                            <span class="track-index">{index}</span>
                            <h4 class="track__title">{track.title}</h4>
                        </article>
                    </template>
                </section>
            </section>
        </ffmpeg-grid>
        <template if:true={cursorInWindow}>
            <ffmpeg-cursor time={editor.cursor}></ffmpeg-cursor>
        </template>
        <template if:true={hasVirtualCursor}>
            <ffmpeg-cursor time={editor.virtualCursor} virtual></ffmpeg-cursor>
        </template>
        <template if:true={isSegmentEditRoute}>
            <div class="resizer"></div>
            <ffmpeg-segmentedit segment-id={route.params.segment_id}></ffmpeg-segmentedit>
        </template>
    </main>
    <section class="master-out">
        <ffmpeg-masterout></ffmpeg-masterout>
    </section>
</template>
