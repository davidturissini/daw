<template>
    <header class="toolbar">
        <ffmpeg-button
            if:true={canDraw}
            selected={isDrawingState}
            class="toolbar__button"
            onclick={onEditButtonClick}
            icon-variant="EditPencil">
        </ffmpeg-button>
        <ffmpeg-button
            if:true={canPan}
            onclick={onIdleButtonClick}
            selected={isIdleState}
            class="toolbar__button"
            icon-variant="HandPaper">
        </ffmpeg-button>
        <ffmpeg-button
            if:true={canClose}
            onclick={onCloseButtonClick}
            class="toolbar__button"
            icon-variant="Times">
        </ffmpeg-button>
    </header>
    <ffmpeg-timeline
        range={visibleRange}
        class="timeline"
        variant="beats"
        tempo={project.tempo}
        markers={topTimelineMarkers}
        ontimelinedrag={onTimelineDrag}>
    </ffmpeg-timeline>
    <main onscroll={onMainScroll}>
        <div class="col-left">
            <slot name="col-left" onslotchange={onColLeftSlotChange}></slot>
        </div>
        <div
            class="grid-container"
            >
            <ffmpeg-audiowindow
                onrectchange={onContainerAudioWindowRectChange}
                onmousedown={onGridContainerMouseDown}
                onmousemove={onGridContainerMouseMove}
                onmouseleave={onGridContainerMouseLeave}
                onclick={onGridContainerClick}
                tempo={project.tempo}
                range={visibleRange}
                show-grid
            >
                <template if:true={durationMarkerIsVisible}>
                    <ffmpeg-cursor
                        class="duration-marker"
                        time={range.duration}
                    ></ffmpeg-cursor>
                </template>
                <template if:true={hoverCursorInRange}>
                    <ffmpeg-cursor
                        time={hoverCursor}
                        dashed
                    ></ffmpeg-cursor>
                </template>
                <slot
                    onmousedown={onRangeDragStart}
                    onmousemove={onRangeDrag}
                    onmouseup={onRangeDragEnd}
                    onslotchange={onRangeSlotChange}
                ></slot>
            </ffmpeg-audiowindow>
            <template for:each={rowLanes} for:item="lane">
                <div class={lane.className} style={lane.style} key={lane.key}></div>}
            </template>
        </div>
    </main>
    <ffmpeg-timeline
        class="time-timeline"
        range={visibleRange}
        tempo={project.tempo}
        ontimelinedrag={onTimelineDrag}>
    </ffmpeg-timeline>
</template>
